<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Welcome, {{user.first_name}}</h1>
    <a href="/logout">Logout</a>
    <hr>
    <div id="navigation">
        <a href="/user_homepage">Home</a>
        <a href="/about_us">About Us</a>
        <a href="/image/all">Project Showcase</a>
        <a href="/class_info">Class Info</a>
        <a href="/request_appointment">Request Appointment</a>
        <a href="#">Helpful Links</a>
    </div>
    <div id="image">
        <h3>{{this_image.title}}</h3>
        <img src="{{this_image.picture.url}}" alt="{{this_image.id}}"><br>
        <a href="#">By: {{this_image.submitter.first_name}}</a>
    </div>
    <div id="wall">
        <form action="/image/{{this_image.id}}/add_message" method="POST">
            {% csrf_token %}
            <label for="message">Post a Message</label><br>
            <textarea name="message" id="message" cols="50" rows="10"></textarea><br>
            <button type="submit">Post a message</button>
        </form>
        
        {% for message in all_messages %}
            <h3>{{message.user.first_name}} {{message.user.last_name}} -- {{message.created_at}}</h3>
            <p>{{ message.message }}</p>
    
            {% if message.user.id == request.session.user_id or user.access_level == 'teacher' %}
            <form action="/image/{{this_image.id}}/delete/{{message.id}}">
                {% csrf_token %}
                <button type="submit">Delete</button>
            </form>
            {% endif %}
    
            <h4>Comments:</h4>
            {% for comment in all_comments %}
                {% if comment.message.id == message.id %}
                    <h5>{{comment.user.first_name}} {{comment.user.last_name}} -- {{comment.created_at}}</h5>
                    <p>{{comment.comment}}</p>
                {% endif %}
            {% endfor %}
    
            <form action="/image/{{this_image.id}}/add_comment" method="POST">
                {% csrf_token %}
                <label for="comment">Post a comment</label><br>
                <input type="hidden" value="{{message.id}}" name='message_id'>
                <textarea name="comment" id="comment" cols="50" rows="2"></textarea><br>
                <button type="submit">Post a comment</button>
            </form>
            
        {% endfor %}
    </div>
</body>
</html>